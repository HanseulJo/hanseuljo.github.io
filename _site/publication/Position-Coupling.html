

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Position Coupling: Improving Length Generalization of Arithmetic Transformers Using Task Structure - Hanseul Cho</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Hanseul Cho">
<meta property="og:title" content="Position Coupling: Improving Length Generalization of Arithmetic Transformers Using Task Structure">


  <link rel="canonical" href="http://localhost:4000/publication/Position-Coupling">
  <meta property="og:url" content="http://localhost:4000/publication/Position-Coupling">



  <meta property="og:description" content="Main Figures">



  <meta name="twitter:site" content="@hanseuljo">
  <meta name="twitter:title" content="Position Coupling: Improving Length Generalization of Arithmetic Transformers Using Task Structure">
  <meta name="twitter:description" content="Main Figures">
  <meta name="twitter:url" content="http://localhost:4000/publication/Position-Coupling">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2024-09-26T00:00:00+09:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Hanseul Cho",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Hanseul Cho Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/assets/icon/apple-touch-icon.png"  color="#000000">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/icon/favicon-32x32.png"  color="#000000">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/icon/favicon-16x16.png"  color="#000000">
<link rel="mask-icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/icon/favicon-32x32.png"  color="#000000">
<link rel="mask-icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/icon/favicon-16x16.png"  color="#000000">
<link rel="shortcut icon" href="http://localhost:4000/assets/icon/favicon.ico">
<link rel="manifest" href="http://localhost:4000/assets/icon/site.webmanifest">

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/">Hanseul Cho</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/posts/">Posts</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://localhost:4000/images/me.jpeg" class="author__avatar" alt="Hanseul Cho">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Hanseul Cho</h3>
    <p class="author__bio">PhD Student at OptiML Lab in KAIST AI. Working on ML/DL/Opt+Theory and LMs.</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li>üìç Seoul, South Korea</li>
      
      
      
        <li><a href="../files/Curriculum_Vitae__Hanseul_Cho.pdf">üìù CV</a></li>
      
      
      
      
       
      
        <li><a href="https://twitter.com/hanseuljo"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
        <li><a href="https://www.linkedin.com/in/hanseul-cho"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="https://github.com/HanseulJo"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.com/citations?user=IczOXwsAAAAJ"><i class="ai ai-google-scholar ai-fw"></i>Google Scholar</a></li>
      
      
        <li><a href="https://www.semanticscholar.org/author/Hanseul-Cho/2187666238"><i class="ai ai-semantic-scholar ai-fw"></i> Semantic Scholar</a></li>
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Position Coupling: Improving Length Generalization of Arithmetic Transformers Using Task Structure">
    <meta itemprop="description" content="Main Figures">
    <meta itemprop="datePublished" content="September 26, 2024">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Position Coupling: Improving Length Generalization of Arithmetic Transformers Using Task Structure
</h1>
          <!---->
        

        <!--Authors-->
        
          <p>
            
            
              üë•
              
                
                
                
                
                
                
                  <a href="http://hanseuljo.github.io/"><b>Hanseul Cho</b></a>*,
                
              
                
                
                
                
                
                
                  Jaeyoung Cha*,
                
              
                
                
                
                
                
                
                  <a href="https://scholar.google.com/citations?user=MDfW21AAAAAJ&hl=en">Pranjal Awasthi</a>,
                
              
                
                
                
                
                
                
                  <a href="https://bsrinadh.github.io">Srinadh Bhojanapalli</a>,
                
              
                
                
                
                
                
                
                  <a href="https://cs.nyu.edu/~anupamg/">Anupam Gupta</a>,
                
              
                
                
                
                
                
                
                  
                    and <a href="http://chulheeyun.github.io/">Chulhee Yun</a>
                  
                
              
            
          </p>
        
        
        <!---Date, Venue, URL-->
        <p>
          
            üóì
            <time datetime="2024-09-26T00:00:00+09:00"> September 26, 2024</time> 
            &nbsp; &nbsp; 
          
          
            üì∞ <a href="https://neurips.cc/Conferences/2024"><b>NeurIPS 2024</b></a> (Short version at ICML 2024 Workshop on <a href="https://longcontextfm.github.io"> Long-Context Foundation Models (LCFM)</a>)
            &nbsp; &nbsp; 
          
          
           üîó
          
          
            [<a href=" https://openreview.net/forum?id=5cIRdGM1uG "><u>paper</u></a>]
          
          
            [<a href=" https://arxiv.org/abs/2405.20671 "><u>arxiv</u></a>]
          
          
            [<a href=" https://github.com/HanseulJo/position-coupling "><u>code</u></a>]
          
        </p>

        

        </header>
      

      <!-- Tag and Category -->
      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/tags/#algorithmic-tasks" class="page__taxonomy-item" rel="tag">Algorithmic Tasks      </a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#arithmetic-tasks" class="page__taxonomy-item" rel="tag">Arithmetic Tasks</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#length-generalization" class="page__taxonomy-item" rel="tag">Length Generalization</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#out-of-distribution-generalization" class="page__taxonomy-item" rel="tag">Out-of-distribution Generalization</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#position-coupling" class="page__taxonomy-item" rel="tag">Position Coupling</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#positional-encoding" class="page__taxonomy-item" rel="tag">Positional Encoding</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#transformers" class="page__taxonomy-item" rel="tag">Transformers</a>
    
    </span>
  </p>




  






  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#icml-workshop" class="page__taxonomy-item" rel="tag">ICML Workshop</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/categories/#neurips" class="page__taxonomy-item" rel="tag">NeurIPS</a>
    
    </span>
  </p>


      </footer>
      
      <section class="page__content" itemprop="text">
        
        <h2 id="main-figures">Main Figures</h2>

<p><img src="../assets/img/position-coupling/Addition_EM_Method_Comparison.png" alt="Position_Coupling1" /></p>

<p><img src="../assets/img/position-coupling/Addition_EM_median_Large.png" alt="Position_Coupling2" /></p>

<p><img src="../assets/img/position-coupling/PositionCouplingForAddition.png" alt="Position_Coupling3" /></p>

<h2 id="abstract">Abstract</h2>

<p>Even for simple arithmetic tasks like integer addition, it is challenging for Transformers to generalize to longer sequences than those encountered during training. To tackle this problem, we propose position coupling, a simple yet effective method that directly embeds the structure of the tasks into the positional encoding of a (decoder-only) Transformer. Taking a departure from the vanilla absolute position mechanism assigning unique position IDs to each of the tokens, we assign the same position IDs to two or more ‚Äúrelevant‚Äù tokens; for integer addition tasks, we regard digits of the same significance as in the same position. On the empirical side, we show that with the proposed position coupling, our models trained on 1 to 30-digit additions can generalize up to 200-digit additions (6.67x of the trained length). On the theoretical side, we prove that a 1-layer Transformer with coupled positions can solve the addition task involving exponentially many digits, whereas any 1-layer Transformer without positional information cannot entirely solve it. We also demonstrate that position coupling can be applied to other algorithmic tasks such as Nx2 multiplication and a two-dimensional task. Our code is available at <a href="https://github.com/HanseulJo/position-coupling">github.com/HanseulJo/position-coupling</a>.</p>

<h2 id="poster">Poster</h2>

<p><img src="../assets/img/position-coupling/Poster_PoCo_NeurIPS2024.png" alt="Position_Coupling4" /></p>

<h2 id="slide">Slide</h2>

<iframe src="https://www.slideshare.net/slideshow/embed_code/key/iNEl39UaLR9HAF" width="960" height="540" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen=""> </iframe>
<div style="margin-bottom:5px"> </div>

        
      </section>
      
      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/publication/Position-Coupling" class="btn btn--twitter" title="Share on Twitter"><i class="fab fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/publication/Position-Coupling" class="btn btn--facebook" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/publication/Position-Coupling" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="http://localhost:4000/publication/DASH" class="pagination--pager" title="DASH: Warm-Starting Neural Network Training in Stationary Settings without Loss of Plasticity
">Previous</a>
    
    
      <a href="http://localhost:4000/publication/Position-Coupling-Scratchpad" class="pagination--pager" title="Arithmetic Transformers Can Length-Generalize in Both Operand Length and Count
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<!-- <a href="/sitemap/">Sitemap</a> -->
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/hanseuljo"><i class="fab fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="https://www.linkedin.com/in/hanseul-cho"><i class="fab fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
    
    
      <li><a href="http://github.com/HanseulJo"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <!--<li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>-->
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Hanseul Cho. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>




  <!-- start custom analytics snippet -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L7J5W90008"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L7J5W90008');
</script>
<!-- end custom analytics snippet -->






  </body>
</html>

